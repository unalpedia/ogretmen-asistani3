<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Asistan Pro V12.5 - Stable Ultimate</title>

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<style>
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&display=swap');
body { font-family: 'Plus Jakarta Sans', sans-serif; background:#f1f5f9; }
.tab-btn{padding:10px 16px;border-radius:14px;font-weight:800;font-size:11px;text-transform:uppercase}
.active-tab{background:#4338ca;color:white}
.no-print{display:block}
@media print{.no-print{display:none!important} body{background:white}}
.podium-1{background:linear-gradient(135deg,#fbbf24,#f59e0b)}
.podium-2{background:linear-gradient(135deg,#e2e8f0,#94a3b8)}
.podium-3{background:linear-gradient(135deg,#ffedd5,#ed8936)}
.crown{font-size:2rem;margin-bottom:-10px}
</style>
</head>

<body>
<div id="root"></div>

<script type="text/babel">
const {useState,useEffect} = React;

const uid = () => Date.now() + Math.random();

function App(){
const [page,setPage] = useState("dashboard");
const [classes,setClasses] = useState(()=>JSON.parse(localStorage.getItem("cls")||"[]"));
const [selClass,setSelClass] = useState(null);
const [students,setStudents] = useState([]);
const [exams,setExams] = useState([]);

useEffect(()=>localStorage.setItem("cls",JSON.stringify(classes)),[classes]);

useEffect(()=>{
 if(!selClass) return;
 setStudents(JSON.parse(localStorage.getItem("s_"+selClass.id)||"[]"));
 setExams(JSON.parse(localStorage.getItem("e_"+selClass.id)||"[]"));
},[selClass]);

const saveStudents = s=>{
 setStudents(s);
 localStorage.setItem("s_"+selClass.id,JSON.stringify(s));
};

const saveExams = e=>{
 setExams(e);
 localStorage.setItem("e_"+selClass.id,JSON.stringify(e));
};

/* ===== MADALYA ===== */
const getBadges = (s)=>{
 const rank = [...students].sort((a,b)=>b.puan-a.puan)
               .findIndex(x=>x.id===s.id)+1;
 const badges=[];
 if(rank===1) badges.push("ğŸ¥‡");
 if(rank<=3) badges.push("ğŸ¥ˆ");
 if(s.puan>=100) badges.push("â­");
 if((s.logs?.length||0)>=10) badges.push("ğŸ”¥");
 return badges.join(" ");
};

/* ===== ANALÄ°Z ===== */
const stats = [...students].map(s=>{
 const nets = exams.map(e=>e.results?.[s.id]?.net).filter(n=>typeof n==="number");
 const avg = nets.length ? nets.reduce((a,b)=>a+b,0)/nets.length : 0;
 return {...s,avg};
}).sort((a,b)=>b.avg-a.avg);

/* ===== TOP3 ===== */
const top3=[...students].sort((a,b)=>b.puan-a.puan).slice(0,3);

return(
<div className="min-h-screen">

<nav className="bg-slate-900 text-white p-5 flex justify-between no-print">
<h1 onClick={()=>{setPage("dashboard");setSelClass(null)}} 
className="font-black cursor-pointer">Asistan Pro V12.5</h1>

{selClass && 
<div className="flex gap-2">
{["list","stats","rank"].map(t=>(
<button key={t} onClick={()=>setPage(t)}
className={`tab-btn ${page===t?"active-tab":"text-slate-300"}`}>
{t.toUpperCase()}
</button>
))}
<button onClick={()=>window.print()}
className="bg-emerald-600 px-4 rounded-xl font-black">PDF</button>
</div>}
</nav>

<main className="p-6 max-w-6xl mx-auto">

{/* DASHBOARD */}
{page==="dashboard" &&
<div className="grid md:grid-cols-3 gap-6 pt-10">
<button onClick={()=>{
 const n=prompt("SÄ±nÄ±f adÄ±:");
 if(n) setClasses([...classes,{id:uid(),name:n}]);
}}
className="h-40 border-4 border-dashed rounded-3xl font-black text-slate-400">
+ Yeni SÄ±nÄ±f
</button>

{classes.map(c=>(
<div key={c.id} onClick={()=>{setSelClass(c);setPage("list")}}
className="bg-white p-8 rounded-3xl shadow cursor-pointer">
<h3 className="font-black text-xl">{c.name}</h3>
</div>
))}
</div>}

{/* LIST */}
{page==="list" && selClass &&
<div className="space-y-6">

{/* PODIUM */}
{students.length>0 &&
<div className="flex justify-center items-end gap-4 h-48">
{top3[1] &&
<div className="text-center">
<div>{top3[1].name}</div>
<div className="podium-2 w-24 h-24 rounded-t-xl flex items-center justify-center">2</div>
</div>}
{top3[0] &&
<div className="text-center">
<div className="crown">ğŸ‘‘</div>
<div>{top3[0].name}</div>
<div className="podium-1 w-28 h-36 rounded-t-xl flex items-center justify-center text-white">1</div>
</div>}
{top3[2] &&
<div className="text-center">
<div>{top3[2].name}</div>
<div className="podium-3 w-24 h-16 rounded-t-xl flex items-center justify-center">3</div>
</div>}
</div>}

<div className="bg-white p-6 rounded-3xl shadow">
<div className="flex justify-between mb-4">
<h2 className="font-black">Ã–ÄŸrenciler</h2>
<button onClick={()=>{
 const n=prompt("Ä°sim:");
 if(n) saveStudents([...students,{id:uid(),name:n,puan:0,logs:[]}]);
}} className="bg-indigo-600 text-white px-4 rounded-xl">+ Ekle</button>
</div>

<div className="grid md:grid-cols-3 gap-3">
{students.map(s=>(
<div key={s.id} className="p-3 border rounded-xl flex justify-between">
<div>
<div className="font-bold">{s.name}</div>
<div>{getBadges(s)}</div>
</div>
<div className="font-black">{s.puan}P</div>
</div>
))}
</div>
</div>
</div>}

{/* STATS */}
{page==="stats" &&
<div className="space-y-4">
<h2 className="text-2xl font-black text-center">ğŸ“Š Ortalama Net</h2>
{stats.map(s=>(
<div key={s.id} className="bg-white p-4 rounded-xl flex justify-between shadow">
<span>{s.name}</span>
<span className="font-black text-indigo-600">{s.avg.toFixed(2)}</span>
</div>
))}
</div>}

{/* RANK */}
{page==="rank" &&
<div className="space-y-3">
<h2 className="text-2xl font-black text-center">ğŸ† Liderlik</h2>
{[...students].sort((a,b)=>b.puan-a.puan).map((s,i)=>(
<div key={s.id} className="bg-white p-4 rounded-xl flex justify-between shadow">
<span>{i+1}. {s.name}</span>
<span className="font-black">{s.puan}P</span>
</div>
))}
</div>}

</main>
</div>
);
}

ReactDOM.createRoot(document.getElementById("root")).render(<App/>);
</script>
</body>
</html>
